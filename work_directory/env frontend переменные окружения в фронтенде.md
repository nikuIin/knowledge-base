[[Frontend]]
[[Var env (переменные окружени)]]


В своих проектах на фронтенде я использую модуль `dotenv`

Установка`
```bash
npm install dotenv
```

Использование:

```ts
import { config as dotenvConfig } from 'dotenv'

// инициализируем env файлы (инициализировать нужно в точке входа)
dotenvConfig(
	{
		// запускаем переменные окружения
		path: ['./.env.developer', './.env', './.env.production'],
		encoding: 'utf8',
		// перезаписывать существующие переменные в `process.env`
		override: true
	}
)

// используем переменные окружения
console.log(process.env.MY_COOL_ENV)
```

**ВАЖНО**

Если мы хотим использовать `env` в файлах проекта, например `tsx`, то мы должны использовать конструкцию:

```ts
const some = import.meta.env.VITE_SOME
```

А также, как видим `vite` кладет хуй на переменные окружения без префикса `VITE_`
Ниже ответ grok
---
Метод config() в модуле dotenv используется для загрузки переменных окружения из файла .env (или другого указанного файла) в объект process.env в Node.js. Это позволяет вашему приложению читать переменные окружения, определённые в .env, как если бы они были установлены в системном окружении.

### Что делает dotenv.config()?

1. **Читает файл .env**:
    - По умолчанию ищет файл .env в корне проекта.
    - Парсит содержимое файла, где переменные указаны в формате КЛЮЧ=ЗНАЧЕНИЕ.
2. **Загружает переменные в process.env**:
    - Добавляет каждую пару ключ-значение из файла в объект process.env.
    - Если переменная с таким именем уже существует в process.env, она **не перезаписывается** (по умолчанию).
3. **Возвращает результат**:
    - Возвращает объект с двумя свойствами:
        - parsed: Объект с распарсенными ключами и значениями из .env.
        - error: Ошибка, если файл не найден или возникла проблема при парсинге (например, неверный синтаксис).

### Пример использования

```js
// Файл: .env
API_BASE_URL=https://api.example.com
API_KEY=your-secret-key
```

```js
// Файл: index.js
import dotenv from 'dotenv';

// Загружаем переменные из .env
const result = dotenv.config();

if (result.error) {
  console.error('Ошибка загрузки .env:', result.error);
} else {
  console.log('Переменные загружены:', result.parsed);
}

// Доступ к переменным
console.log(process.env.API_BASE_URL); // https://api.example.com
console.log(process.env.API_KEY); // your-secret-key
```

### Важные детали

- **Вызов config()**:
    - Обычно вызывается в начале приложения, до использования process.env.
    - Вызывать нужно только один раз, чтобы избежать дублирования.
- **Опции**: config() принимает объект с параметрами:
```js
dotenv.config({
  path: './custom.env', // Указать другой файл вместо .env
  encoding: 'utf8', // Кодировка файла
  override: true, // Перезаписывать существующие переменные в process.env
});
```

- **Vite и dotenv**: В контексте Vite модуль dotenv часто используется на бэкенде (например, с FastAPI), но для фронтенда (React) Vite сам обрабатывает .env файлы через import.meta.env. Если вы используете dotenv для фронтенда, это может быть нестандартным подходом, так как Vite имеет встроенную поддержку переменных окружения (с префиксом VITE_).

### Ограничения и рекомендации

- **Безопасность**: Не храните чувствительные данные (например, API-ключи) в .env, если файл может попасть в репозиторий. Используйте секреты CI/CD или vault-решения.
- **Vite**: Если ваш фронтенд работает на Vite, используйте встроенную систему переменных окружения (VITE_*) вместо dotenv для фронтенда. Для бэкенда (FastAPI) dotenv — отличный выбор.
- **Ошибки**: Проверяйте result.error, чтобы обрабатывать случаи, когда .env отсутствует или содержит ошибки.

### Документация

- [Официальная документация dotenv](https://github.com/motdotla/dotenv#options)
- [Vite: Environment Variables](https://vitejs.dev/guide/env-and-mode.html)
