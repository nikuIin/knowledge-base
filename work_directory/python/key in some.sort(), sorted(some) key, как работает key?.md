
А как работает key в sort()? Он применяется к каждому элементу и потом идет сортировка по новым данным?

Да, вы совершенно правы! Именно так и работает аргумент key в функциях sort() (метод списка) и sorted() (встроенная функция).

Вот как это происходит:

1.  Функция key применяется к каждому элементу: Перед тем, как начать сортировку, функция, переданная в аргументе key, вызывается для *каждого* элемента в исходном списке (или итерируемом объекте). Результат вызова этой функции для каждого элемента сохраняется во временной структуре данных.

2.  Сортировка на основе возвращаемых значений:  Сортировка выполняется *не* по исходным элементам списка, а по значениям, которые вернула функция key для этих элементов.  То есть, используется не сам элемент, а результат применения к нему key.

3.  Возврат исходного порядка (если значения key равны): Если для двух элементов функция key возвращает одинаковые значения, то их порядок в отсортированном списке сохраняется таким же, как и в исходном списке (если сортировка стабильная, как в Python).

4.  Формирование отсортированного списка:  После того, как определен порядок элементов на основе значений, возвращенных функцией key, создается новый отсортированный список (в случае sorted()) или изменяется исходный список (в случае list.sort()).  При этом в результирующий список помещаются *исходные* элементы, а не значения, возвращенные функцией key.

Пример для иллюстрации:
```python
data = ["apple", "banana", "Cherry", "date"]

# Сортировка без учета регистра (по алфавиту)
sorted_data = sorted(data, key=str.lower)  # str.lower - функция, приводящая строку к нижнему регистру

print(sorted_data)  # Вывод: ['apple', 'banana', 'Cherry', 'date']
```

В этом примере:

*   str.lower – это функция, которая приводится к нижнему регистру. Она вызывается для каждого элемента списка data.
*   Сортировка происходит на основе значений, возвращаемых str.lower (то есть, "apple", "banana", "cherry", "date").
*   Но в результирующий список sorted_data попадают *исходные* элементы списка data, но уже в отсортированном порядке.

Важные моменты:

*   Функция key должна принимать один аргумент (элемент списка) и возвращать значение, которое можно сравнивать.
*   key не меняет исходные элементы списка, а только влияет на порядок их сортировки.
*   Если key не указан, то сортировка происходит непосредственно по элементам списка (с использованием операторов сравнения <, >, ==, и т.д.).