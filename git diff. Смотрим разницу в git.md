[[Версионность git (коммиты)]]
## diff в текущем состоянии

Самое главное, что нужно знать о `git diff` это то, что это команда без флагов сравнивает файлы вашей директории (текущее) с индексом и только!

Что это значит? Это значит то, что если вы внесли изменения в директорию, но не занесли файлы в индекс, то вы будете видеть изменения в выводе `git diff`. Но как только вы занесете все файлы с помощью команды `git add [mask]` в индекс, то `git diff` их не будет учитывать. 

Еще раз, `git diff` сравнивает файлы в вашем проекте с индексом!

Чтобы посмотреть разницу между индексом и локальным хранилищем, нужно использовать команду:
```bash
git diff --cached
git diff --staged
```

Обе команды идентичны.

Помните, что тут сравнивается **только индекс и локалка**, это значит что файлы в директории, которые не входят в индекс не сравниваются ни с чем. Для их сравнения используйте предыдущую вариацую команды.

### Что за части выводит `diff`?

`diff` показывает нам изменения частей в файлах, а не все файлы. Если бы он выводил все сотник тысяч строк файлов, с которыми мы бы работали, наша консоль бы их просто не уместила. 

`diff` выводит **ханки**. **Ханк** — это часть, кусок изменения. 
Вывод `diff`:
```bash
diff --git a/2.txt b/2.txt
index 964480f..190a180 100644
--- a/2.txt
+++ b/2.txt
@@ -1 +1 @@
-213
+123
```

Ханк начинается с *@@*, то есть заголовка. В нашем случае он пустой, но может содержать какую-либо пояснительную строку. Далее внутри него мы видим числа **-1** и *+1*. Это показати строк, *+ это файл в директории*, **-** **это файл индекса**.

Также в `diff` указываются файлы как `a/2.txt` и `b/2.txt` — это показывают нам, что именно сравнивается. `a - индекс`, `b – директория.`

Далее также он показывает в теле ханка *+* и **-** строки, эти знаки просто показывают к какому файлу принадлежат эти строки.

Строки могут идти через **,**
Это означает, например если видим *6,3*, то нам показываются изменения со строки 6 по 9. `6 + 3 = 9`. 

#### Смотрим разницу не по строкам, а по словам

Благодаря этой команды мы сможем увидеть разницу в файлах по словам.
```bash
git diff --word-diff
```

## Что можно еще сравнивать с помощью `diff`?

На самом деле ВСЕ. Главное просто понять, что первый аргумент в `diff` помечается как **-**, а второй как *+*

Это означает, что если вы хотите, например сравнить более старую ветку ([[Ветки в git]]) с более новой, вы должны так и написать:

```bash
git diff old_branch new_branch
```

Тогда новая ветка будет помечаться как *+*

Также и с коммитами, более новый коммит должен быть **справа**:

```bash
git diff 32rs34f 23fs53f
```

### Как `diff` сравнивает файл с несуществующим файлом?

Хороший вопрос! Все просто, он помечает второй файл как `dev/null`, то есть нечего сравнивать. => все строки будут идти с *+*.

## Инструменты `difftool`

Мы можем использовать разные инструменты для отображения изменений, для этого используем команду:

```bash
git difftool --tool=<тулза>
```

Я юзаю эту:

```bash
git difftool --tool=nvimdiff
```